seed: 0
device: cpu
dtype: float32
state_dtype: complex64
data:
  family: line
  N: 64
  seed: 1234
  directed: false
  grid:
    Lx: 8
    Ly: 8
  regular:
    d: 3
  er:
    p: 0.05
  ws:
    Lx: 8
    Ly: 8
    kx: 1
    ky: 1
    beta: 0.2
    torus: false
  train_sizes:
    mode: fixed_list
    fixed_list:
    - 64
    - 96
    - 128
    - 160
    - 192
    band:
      N_min: 64
      N_max: 192
  val_sizes:
    mode: fixed_list
    fixed_list:
    - 80
    - 112
    - 176
  test_iid_sizes:
    mode: fixed_list
    fixed_list:
    - 96
    - 160
  test_ood_sizes:
    mode: fixed_list
    fixed_list:
    - 256
    extra_optional:
    - 320
  ensure_connected: true
  batching:
    episodes_per_graph: 1
    graphs_per_batch_train: 8
    graphs_per_batch_eval: 4
    shuffle_train: true
  manifests:
    enabled: true
    root_dir: acpl/data/manifests
    val_manifest: transfer-line-val.json
    test_iid_manifest: transfer-line-test-iid.json
    test_ood_manifest: transfer-line-test-ood.json
    episodes:
      val: 200
      test_iid: 200
      test_ood: 300
    build:
      seed: 1234
      horizon_policy: per_horizon_manifest
      per_horizon:
        enabled: true
        horizons:
        - 64
        - 96
        - 128
      episode_seed_base: 900000
features:
  use_degree: true
  degree_onehot_K: 16
  degree_log1p: false
  degree_norm: inv_sqrt
  use_coords: true
  coords_normalize: true
  use_indicator: false
  use_lap_pe: true
  lap_pe_k: 16
  lap_pe_norm: sym
  lap_pe_random_sign: true
  use_rwse: true
  rwse_K: 16
  rwse_aggregation: diag
  use_role_encodings: true
  role_degree_bins_K: 8
  role_include_leaf: true
  role_include_hub: true
  role_hub_percentile: 0.9
  role_include_grid_boundary: true
  use_bitstrings: false
  build_arcs: false
  eps: 1.0e-12
  seed: 42
  include_degree: true
  coord_1d:
    enabled: true
    normalize: true
    center: false
  laplacian_pe:
    enabled: false
    k: 16
    sign_fix: max-abs-positive
sim:
  steps: 64
  curriculum:
    enabled: true
    schedule:
    - horizon_T: 64
      epochs: 20
    - horizon_T: 96
      epochs: 20
    - horizon_T: 128
      epochs: 30
  rollout:
    check_unitarity: false
    check_simplex_every: 0
task:
  name: transfer
  target_index: -1
  target_radius: 3
  init_state: node0
  use_indicator: false
  source_index: 0
  loss:
    kind: nll
    time_agg: last
    tau: 0.2
    eps: 1.0e-08
    label_smoothing: 0.0
    cvar_alpha: 0.1
    margin: 0.0
    reduction: mean
    normalize_prob: true
    check_simplex: false
loss:
  kind: nll
  reduction: mean
  normalize_prob: true
  eps: 1.0e-08
  margin: 0.0
  cvar_alpha: 0.1
  mix_kind: tv
  mix_eps: 1.0e-12
model:
  gnn:
    kind: gcn
    hidden: 64
    out: 64
    dropout: 0.0
    layers: 3
    hidden_dim: 64
    norm: graphnorm
    residual: true
  controller:
    kind: gru
    hidden: 64
    layers: 1
    dropout: 0.0
    bidirectional: true
    hidden_dim: 64
    time_pe_dim: 32
    normalized_time_feature: true
  head:
    hidden: 0
    dropout: 0.0
    layernorm: true
    kind: mlp
    hidden_dim: 0
    activation: gelu
  time_pe_dim: 32
  time_pe_learned_scale: true
  coin:
    family: su2
    theta_scale: 1.0
    theta_noise_std: 0.0
    clamp:
      enabled: false
      min: -3.14159
      max: 3.14159
coin:
  family: su2
  theta_scale: 1.0
  theta_noise_std: 0.0
optim:
  name: adam
  lr: 0.003
  weight_decay: 0.0
  betas:
  - 0.9
  - 0.999
  grad_clip:
    enabled: true
    mode: norm
    max_norm: 1.0
  precision:
    amp: true
  scheduler:
    kind: none
  eps: 1.0e-08
  regularizers:
    temporal_smoothness: 0.0
    magnitude: 0.0
    spectral:
      enabled: false
      dct_weight: 0.0
      hf_bins: 0.25
train:
  epochs: 120
  batch_size: 1
  episodes_per_epoch: 200
  verify_checkpoints: true
  ci_n_seeds: 5
  ci_episodes: 100
  run_dir: runs/transfer-line/seed0
log:
  backend: console
  interval: 50
  ci_bootstrap_samples: 1000
  ci_alpha: 0.05
  wandb:
    enabled: false
    project: acpl-qwalk
    run_name: A6_line64_T64_gcn_gru_su2
compile:
  enabled: false
  backend: aot_eager
  force_inductor: false
experiment:
  name: transfer-line
  goal: state transfer on line graphs
  description: 'Pre-registered experiment evaluating Adaptive Coin Policy Learning
    (ACPL) on state transfer over 1D line graphs. Trains on a band of sizes and evaluates
    both IID and OOD generalization. Includes strong baselines and ablations, CI-style
    evaluation, and interpretability artifacts (node embeddings + variance).

    '
  tags:
  - transfer
  - line
  - ood
  - ablations
  - baselines
  - embeddings
  - ci
  notes: SU(2) degree-2 coins; curriculum over horizon T; fixed val/test manifests.
defaults:
  task_config: acpl/configs/task/transfer.yaml
  optim_config: acpl/configs/optim.yaml
repro:
  master_seed: 0
  train_seeds:
  - 0
  - 1
  - 2
  eval_seeds:
  - 101
  - 102
  - 103
  - 201
  - 202
  deterministic_torch: true
  cublas_workspace_config: :4096:8
  pythonhashseed: 0
  save_git_info: true
  save_resolved_config: true
comparisons:
  baselines:
  - name: fixed_hadamard
    enabled: true
    description: Standard fixed Hadamard coin everywhere, all times.
  - name: fixed_grover
    enabled: false
    description: Grover diffusion coin (mostly relevant for regular graphs, optional
      for line).
  - name: global_time_coin
    enabled: true
    description: "\u03B8(t) learned but shared across nodes (time-adaptive only)."
  - name: node_only_coin
    enabled: true
    description: "\u03B8(v) learned but constant over time (spatial-adaptive only)."
  - name: random_fixed_coin
    enabled: true
    description: Seeded random fixed SU(2) coin, sanity baseline.
  ablations:
  - name: nope
    enabled: true
    description: Remove positional encodings; keep degree feature.
  - name: globalcoin
    enabled: true
    description: "Force \u03B8(v,t)=\u03B8(t) even for ACPL model."
  - name: timefrozen
    enabled: true
    description: "Force \u03B8(v,t)=\u03B8(v) (no temporal adaptivity)."
  - name: nodepermute
    enabled: true
    description: Permutation equivariance sanity test.
eval:
  enabled: true
  ci:
    alpha: 0.1
    n_eval_seeds: 5
    episodes_per_seed:
      val: 100
      test_iid: 100
      test_ood: 150
    method: bootstrap
    bootstrap:
      n_resamples: 2000
      block_by: episode
  metrics:
  - target/success
  - target/maxp
  - target/nll
  - mix/tv
  - mix/H
  robustness:
    enabled: false
    edge_phase:
      sigma_grid:
      - 0.0
      - 0.05
      - 0.1
      trials: 8
  artifacts:
    write_dir: eval
    write_ci: true
    write_per_seed: true
    write_tables: true
    write_json: true
    stats:
      enabled: true
      quantiles:
      - 0.05
      - 0.25
      - 0.5
      - 0.75
      - 0.95
      include_probability_checks: true
      include_unitarity_checks: false
      include_time_series: true
    embeddings:
      enabled: true
      source: gnn
      aggregate_time: last
      max_nodes_for_plot: 256
      pca:
        enabled: true
        n_components: 2
      color_by:
      - coord_1d
      - distance_to_target
      - degree
      save:
        raw_pt: true
        raw_csv: true
        pca_csv: true
        pca_png: true
        stats_json: true
    plots:
      enabled: true
      pt_target_curve: true
      final_distribution: true
      theta_spectra: true
      tv_curve: true
success_criteria:
  transfer_threshold:
    metric: target/success
    split: test_ood
    threshold: 0.9
  ci_improvement:
    metric: target/success
    split: test_ood
    min_abs_improvement: 0.02
  nll_sanity:
    metric: target/nll
    split: test_ood
    max_value: 0.2
compute:
  device: auto
  dtype: float32
  amp: true
  wallclock_limit_min: 120
  max_memory_gb: 8
  track_throughput: true
  profile:
    enabled: false
    warmup_steps: 50
    profile_steps: 100
