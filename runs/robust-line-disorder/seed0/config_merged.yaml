seed: 0
device: cpu
dtype: float32
state_dtype: complex64
data:
  family: line
  N: 64
  seed: 1234
  directed: false
  grid:
    Lx: 8
    Ly: 8
  regular:
    d: 3
  er:
    p: 0.05
  ws:
    Lx: 8
    Ly: 8
    kx: 1
    ky: 1
    beta: 0.2
    torus: false
  train_sizes:
    mode: fixed_list
    fixed_list:
    - 64
    - 96
    - 128
    - 160
    - 192
  val_sizes:
    mode: fixed_list
    fixed_list:
    - 72
    - 136
    - 184
  test_iid_sizes:
    mode: fixed_list
    fixed_list:
    - 96
    - 128
    - 160
  test_ood_sizes:
    mode: fixed_list
    fixed_list:
    - 256
  batching:
    episodes_per_graph: 1
    graphs_per_batch_train: 2
    graphs_per_batch_eval: 1
    shuffle_train: true
  manifests:
    enabled: true
    root_dir: acpl/data/manifests
    val_manifest: robust-line-disorder-val.json
    test_iid_manifest: robust-line-disorder-test-iid.json
    test_ood_manifest: robust-line-disorder-test-ood.json
    episodes:
      val: 120
      test_iid: 120
      test_ood: 150
    build:
      seed: 1447
      episode_seed_base: 920000
      horizon_policy: per_horizon_manifest
      per_horizon:
        enabled: true
        horizons:
        - 64
        - 96
        - 128
features:
  use_degree: true
  degree_onehot_K: 16
  degree_log1p: false
  degree_norm: inv_sqrt
  use_coords: true
  coords_normalize: true
  use_indicator: false
  use_lap_pe: true
  lap_pe_k: 16
  lap_pe_norm: sym
  lap_pe_random_sign: true
  use_rwse: true
  rwse_K: 16
  rwse_aggregation: diag
  use_role_encodings: true
  role_degree_bins_K: 8
  role_include_leaf: true
  role_include_hub: true
  role_hub_percentile: 0.9
  role_include_grid_boundary: true
  use_bitstrings: false
  build_arcs: false
  eps: 1.0e-12
  seed: 42
  include_degree: true
  coords:
    enabled: true
    kind: coord_1d
    normalize: true
  laplacian_pe:
    enabled: false
    k: 8
    sign_fix: max-abs-positive
sim:
  steps: 64
  curriculum:
    enabled: false
  rollout:
    check_unitarity: false
    check_simplex_every: 0
task:
  name: robust
  target_index: 63
  target_radius: 0
  init_state: node0
  use_indicator: false
  objective: maximize robust success at target j*
  normalized_time_feature: true
  horizon_T: 128
  line:
    source: left
    target: right
  loss:
    kind: robust_combo
    cvar_alpha: 0.1
    reduction: mean
    clamp_min_p: 1.0e-09
loss:
  kind: nll
  reduction: mean
  normalize_prob: true
  eps: 1.0e-08
  margin: 0.0
  cvar_alpha: 0.1
  mix_kind: tv
  mix_eps: 1.0e-12
model:
  gnn:
    kind: gin
    hidden: 64
    out: 64
    dropout: 0.1
    layers: 2
    hidden_dim: 128
    norm: graphnorm
    residual: true
  controller:
    kind: gru
    hidden: 64
    layers: 1
    dropout: 0.1
    bidirectional: false
    hidden_dim: 128
    time_pe_dim: 32
    normalized_time_feature: true
  head:
    hidden: 0
    dropout: 0.0
    layernorm: true
  time_pe_dim: 32
  time_pe_learned_scale: true
  coin:
    family: su2
    theta_scale: 1.0
    theta_noise_std: 0.0
coin:
  family: su2
  theta_scale: 1.0
  theta_noise_std: 0.0
optim:
  name: adamw
  lr: 0.00025
  weight_decay: 1.0e-05
  betas:
  - 0.9
  - 0.999
  grad_clip:
    enabled: true
    mode: norm
    max_norm: 1.0
  precision:
    amp: true
  scheduler:
    kind: cosine_warmup
    cosine_warmup:
      warmup_steps: 500
      t_max: 12000
      eta_min: 1.0e-05
  eps: 1.0e-08
  regularizers:
    temporal_smoothness: 0.002
    magnitude: 1.0e-05
    spectral:
      enabled: true
      dct_weight: 0.0001
      hf_bins: 0.5
train:
  epochs: 120
  batch_size: 1
  episodes_per_epoch: 200
  verify_checkpoints: true
  ci_n_seeds: 5
  ci_episodes: 100
  run_dir: runs/robust-line-disorder/seed0
log:
  backend: console
  interval: 50
  ci_bootstrap_samples: 1000
  ci_alpha: 0.05
  wandb:
    enabled: false
    project: acpl-qwalk
    run_name: A6_line64_T64_gcn_gru_su2
compile:
  enabled: false
  backend: aot_eager
  force_inductor: false
experiment:
  name: robust-line-disorder
  goal: robust transport on line graphs with static edge-phase disorder
  description: 'Pre-registered evaluation of ACPL under edge-phase disorder on 1D
    lines. We report mean success and CVaR_0.1 success at the target, and sweep sigma
    to produce robustness curves. We include IID and OOD size tests and ablation studies.

    '
  tags:
  - robust
  - line
  - edge_phase
  - cvar
  - ood
  - ablations
  - baselines
  - ci
  notes: 'Disorder is applied as static edge phases sampled once per episode and held
    fixed across the walk. Evaluation uses multiple disorder draws per episode (trials).

    '
defaults:
  task_config: acpl/configs/task/robust.yaml
  optim_config: acpl/configs/optim.yaml
repro:
  master_seed: 1234
  train_seeds:
  - 0
  - 1
  - 2
  - 3
  - 4
  eval_seeds:
  - 551
  - 552
  - 553
  - 651
  - 652
  deterministic_torch: true
  cublas_workspace_config: :4096:8
  pythonhashseed: 0
  save_git_info: true
  save_resolved_config: true
disorder:
  train:
    edge_phase:
      enabled: true
      sigma: 0.1
      wrap: true
      trials_per_episode: 1
    coin_dephase:
      enabled: false
      sigma: 0.0
    edge_dropout:
      enabled: false
      p: 0.0
  eval:
    edge_phase:
      enabled: true
      sigma_grid:
      - 0.0
      - 0.05
      - 0.1
      - 0.15
      - 0.2
      trials: 8
    coin_dephase:
      enabled: false
      sigma_grid:
      - 0.0
      - 0.05
      - 0.1
      trials: 6
training:
  method: backprop
  epochs: 160
  steps_per_epoch: 400
  accum_steps: 1
  amp: true
  device: cuda
  log_every: 50
  log_grad_norm_every: 200
  ckpt:
    dir: checkpoints/robust-line-disorder
    keep_last: 6
    save_every_steps: 2000
    save_best_metric: eval/target/success
comparisons:
  baselines:
  - name: fixed_hadamard
    enabled: true
    description: Fixed Hadamard coin on degree-2 line (classic).
  - name: global_time_coin
    enabled: true
    description: "\u03B8(t) learned but shared across nodes; tests node-adaptivity\
      \ importance."
  - name: node_only_coin
    enabled: true
    description: "\u03B8(v) learned but constant over time; tests time-adaptivity\
      \ importance."
  - name: fixed_random_su2
    enabled: true
    description: Seeded random fixed SU(2) coin baseline.
  ablations:
  - name: no_robustness
    enabled: true
    description: Train without disorder (sigma=0) then evaluate under sigma sweep.
  - name: cvar_off
    enabled: true
    description: Set cvar_alpha=0 (pure expectation), compare tail-risk behavior.
  - name: mc1
    enabled: true
    description: Set monte_carlo.episodes=1 to show variance/robustness tradeoff.
  - name: smooth0
    enabled: true
    description: Set temporal_smoothness=0 to test smooth schedule importance.
eval:
  enabled: true
  ci:
    alpha: 0.1
    n_eval_seeds: 5
    episodes_per_seed:
      val: 80
      test_iid: 80
      test_ood: 100
    method: bootstrap
    bootstrap:
      n_resamples: 2000
      block_by: episode
  metrics:
  - target/success
  - target/maxp
  - target/cvar_success
  - mix/tv
  - mix/H
  robustness:
    enabled: true
    edge_phase:
      sigma_grid:
      - 0.0
      - 0.05
      - 0.1
      - 0.15
      - 0.2
      trials: 8
  artifacts:
    write_dir: eval
    write_ci: true
    write_per_seed: true
    write_tables: true
    write_json: true
    stats:
      enabled: true
      quantiles:
      - 0.05
      - 0.25
      - 0.5
      - 0.75
      - 0.95
      include_probability_checks: true
      include_time_series: true
      include_robust_sweep_tables: true
    embeddings:
      enabled: true
      source: gnn
      aggregate_time: last
      max_nodes_for_plot: 2048
      pca:
        enabled: true
        n_components: 2
      color_by:
      - coord_1d
      - degree
      - target_distance
      save:
        raw_pt: true
        raw_csv: true
        pca_csv: true
        pca_png: true
        stats_json: true
    plots:
      enabled: true
      success_vs_sigma: true
      cvar_vs_sigma: true
      tv_curve: true
      theta_spectra: true
success_criteria:
  cvar_alpha: 0.1
  cvar_improvement:
    metric: target/cvar_success
    split: test_ood
    min_abs_improvement: 0.03
  mean_success_improvement:
    metric: target/success
    split: test_ood
    min_abs_improvement: 0.03
compute:
  device: auto
  dtype:
    encoder: float32
    state: complex128
  amp: true
  wallclock_hours: 16
  max_memory_gb: 24
  track_throughput: true
